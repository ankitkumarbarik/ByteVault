<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ByteVault</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Premium Animated Background Orbs -->
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>
    <div class="bg-orb orb-3"></div>

    <div id="toast-container" class="toast-container"></div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen hidden">
      <div class="auth-card">
        <div class="icon-wrap">
          <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
          </span>
        </div>
        <h2>Welcome Back</h2>
        <p>Sign in to ByteVault to sync your links.</p>
        <form id="login-form">
          <div class="input-group">
            <span class="input-icon">
              <!-- Envelop Icon -->
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2" ry="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
            </span>
            <input
              type="email"
              id="login-email"
              class="input with-icon"
              placeholder="Email address"
              required
            />
          </div>
          <div class="input-group">
            <span class="input-icon">
              <!-- Key/Lock Icon -->
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z"/><circle cx="16.5" cy="7.5" r=".5" fill="currentColor"/></svg>
            </span>
            <input
              type="password"
              id="login-password"
              class="input with-icon"
              placeholder="Password"
              required
              minlength="6"
            />
          </div>
          <button type="submit" class="btn btn-primary w-full">Sign In</button>
        </form>
        <div class="auth-switch">
          Don't have an account?
          <span id="to-register" class="link">Sign up</span>
        </div>
      </div>
    </div>

    <!-- Register Screen -->
    <div id="register-screen" class="screen hidden">
      <div class="auth-card">
        <div class="icon-wrap">
          <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          </span>
        </div>
        <h2>Join ByteVault</h2>
        <p>Create an account to start syncing.</p>
        <form id="register-form">
          <div class="input-group">
            <span class="input-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2" ry="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
            </span>
            <input
              type="email"
              id="register-email"
              class="input with-icon"
              placeholder="Email address"
              required
            />
          </div>
          <div class="input-group">
            <span class="input-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z"/><circle cx="16.5" cy="7.5" r=".5" fill="currentColor"/></svg>
            </span>
            <input
              type="password"
              id="register-password"
              class="input with-icon"
              placeholder="Password"
              required
              minlength="6"
            />
          </div>
          <button type="submit" class="btn btn-primary w-full">
            Create Account
          </button>
        </form>
        <div class="auth-switch">
          Already have an account?
          <span id="to-login" class="link">Log in</span>
        </div>
      </div>
    </div>

    <!-- Dashboard Screen -->
    <div id="dashboard-screen" class="screen hidden">
      <header class="app-header">
        <div class="logo-flex" style="display: flex; align-items: center; gap: 8px;">
          <img src="icons/icon48.png" alt="ByteVault Logo" style="width: 24px; height: 24px; object-fit: contain;">
          <h1>ByteVault</h1>
        </div>
        <div class="header-actions">
          <button id="theme-toggle" class="icon-btn" title="Toggle Theme">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          </button>
          <button id="logout-btn" class="icon-btn danger" title="Logout">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
          </button>
        </div>
      </header>

      <main class="dashboard-content">
        <!-- Header User Area -->
        <div class="user-welcome">
          <span id="user-name-disp">Hi, User</span>
        </div>

        <!-- View Toggle -->
        <div class="view-toggle">
          <button id="view-tabs-btn" class="toggle-btn active">
            Saved Tabs
          </button>
          <button id="view-sessions-btn" class="toggle-btn">
            Saved Sessions
          </button>
        </div>

        <!-- Quick Actions Container -->
        <div class="action-panel">
          <!-- Action Buttons -->
          <div class="action-buttons">
            <button id="save-active-btn" class="btn btn-primary flex-1">
              Save Current Tab
            </button>
            <button id="save-all-btn" class="btn outline flex-1">
              Save All Tabs
            </button>
          </div>
          <!-- Open Dashboard Button -->
          <button id="open-dashboard-btn" class="btn outline w-full mt-2">
            Open Full Dashboard ↗
          </button>
        </div>

        <!-- List Area -->
        <div class="list-panel">
          <div class="list-header">
            <input
              type="text"
              id="search-input"
              class="input w-full"
              placeholder="Search titles or URLs..."
            />
          </div>

          <div class="list-body relative">
            <div id="loading-spinner" class="spinner center"></div>
            <div id="empty-state" class="empty-msg hidden">
              Your vault is empty.
            </div>

            <div id="links-list" class="links-scroll">
              <!-- Dinamically injected cards go here -->
            </div>
          </div>

          <!-- Pagination & Bottom Actions -->
          <div class="list-footer">
            <div class="pagination">
              <button id="prev-page" class="icon-btn" disabled>«</button>
              <span id="page-indicator" class="text-xs">Page 1 of 1</span>
              <button id="next-page" class="icon-btn" disabled>»</button>
            </div>
            <button id="export-btn" class="btn text-btn text-xs">
              ⬇ Export All
            </button>
          </div>
        </div>
      </main>

      <!-- Save All Tabs Modal -->
      <div id="save-all-modal" class="modal hidden">
        <div class="modal-content auth-card" style="padding: 24px 28px; text-align: left; width: 340px; box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6); position: relative;">
          <h3 style="font-size:18px; font-weight:700; color:white; margin-bottom: 6px;">Save All Tabs</h3>
          <p style="font-size:13px; color:#9ca3af; margin-bottom:24px; line-height:1.5; padding-right:12px;">
            Do you want to create a new session or merge into an existing one?
          </p>
          
          <button id="modal-close" class="icon-btn close-modal" style="position: absolute; top: 18px; right: 18px; background:transparent; border:none; border-radius: 50%; width: 28px; height: 28px; display:flex; align-items:center; justify-content:center; color:var(--text-muted); font-size:18px; cursor:pointer;">✕</button>
          
          <div class="modal-actions" style="display: flex; gap: 8px; margin-bottom: 24px;">
            <button id="modal-new-session" class="btn btn-primary" style="flex:1; font-weight:600; font-size:13px; padding:10px 14px; border-radius:10px;">
              New Session
            </button>
            <button id="modal-merge-session" class="btn outline" style="flex:1; font-weight:600; font-size:13px; padding:10px 14px; border-radius:10px; background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255,255,255,0.08);">
              Merge to Existing
            </button>
          </div>
          
          <!-- New Session Form -->
          <form id="new-session-form" class="hidden" style="display:flex; flex-direction:column; gap:12px;">
            <input type="text" id="session-name" class="input" style="padding:12px 14px; font-size:13px;" placeholder="Session Name" required />
            <input type="text" id="session-desc" class="input" style="padding:12px 14px; font-size:13px;" placeholder="Description (Optional)" />
            <input type="text" id="session-tag" class="input" style="padding:12px 14px; font-size:13px;" placeholder="Tag (Optional)" />
            <button type="submit" class="btn btn-primary w-full" style="margin-top:12px; font-weight:600; padding:12px; font-size:14px; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
              Create & Save
            </button>
          </form>
          
          <!-- Merge Session Form -->
          <form id="merge-session-form" class="hidden" style="display:flex; flex-direction:column; gap:12px;">
            <select id="merge-session-select" required class="input" style="padding:12px 14px; font-size:13px; appearance: none; background-image: url('data:image/svg+xml;utf8,<svg fill=%22%239ca3af%22 height=%2224%22 viewBox=%220 0 24 24%22 width=%2224%22 xmlns=%22http://www.w3.org/2000/svg%22><path d=%22M7 10l5 5 5-5z%22/></svg>'); background-repeat: no-repeat; background-position-x: calc(100% - 12px); background-position-y: center;">
              <option value="">Loading sessions...</option>
            </select>
            <button type="submit" class="btn btn-primary w-full" style="margin-top:12px; font-weight:600; padding:12px; font-size:14px; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
              Merge & Save
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Orchestrate Logic -->
    <script type="module" src="popup.js"></script>
  </body>
</html>
